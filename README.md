# 简介

本部分是基于开源项目  https://github.com/al0ne/LinuxCheck  的一个漏洞评估工具，使用go语言进行重写，在实现各模块的基础之上对部分功能进行扩展。

# 使用方法

```shell
rm ./go.mod
go mod init test
go build -buildvcs=false -o test
```

fuzz部分使用前注意进行如下配置：

```shell
sysctl kernel.core_pattern=core
```

## sql-insert

```shell
docker search sqli-labs
docker pull acgpiano/sqli-labs
```

接下来，一条关键命令启动靶场：

```shell
docker run -dt --name sqli-labs -p 8081:80 --rm acgpiano/sqli-labs，
#-dt为后台运行，
#--name为给该镜像命名（我这里名字命为sqli-labs），
#-p指定端口，将docker的80端口映射到本机的8081端口，
#--rm为设置docker在退出时自动清理内部的文件系统。
```

此时我们浏览器输入127.0.0.1:8081即可看到靶场了

## go-version

在内核版本识别模块@JuicyMio使用了go-version这个包，如果自己的Linux环境能够访问外网的话，可以有如下安装方式：

```shell
go get github.com/hashicorp/go-version
```

否则，则要采用@q1ming的离线安装方式：

首先下载包：

https://github.com/hashicorp/go-version/archive/refs/heads/main.zip

然后解压，笔者解压在了项目地址的上层目录；

然后改写go.mod文件如下：

```
module test

go 1.18

require github.com/hashicorp/go-version v1.0.0

replace github.com/hashicorp/go-version => ../go-version-main

```

之后运行如下命令整理依赖项：

```shell
go mod tidy
```

之后运行如下命令验证设置：

```shell
go mod vendor
```

最后编译：

```
#!/bin/bash
go build -buildvcs=false -o test
```

## build.sh

新版的build采用静态链接，便于跨平台使用：

```shell
#!/bin/bash
CGO_ENABLED=0 go build -buildvcs=false -o test
```



# 注意事项

## kernel-cve

CVE-2022-0847 Linux Dirty Pipe本地提权漏洞   用的时候有点问题 

CVE-2021-43267 Linux kernel TIPC任意代码执行权限提升漏洞  找不到源码

CVE-2021-33909 Linux kernel本地提权漏洞  exp.sh中要传入第二个参数，用于创建文件夹，只能说很奇怪，还必须是绝对路径，跑半天还卡在一个不动，建议不要
这是一开始遇到的一些问题

# Refactor

目录结构

```
.
├── client                          # 客户端
│   ├── exploit                     # 验证漏洞
│   ├── config.go                   # 配置文件
│   ├── go.mod
│   ├── go.sum
│   ├── inforCollect                # 信息收集
│   │   ├── ip.go
│   │   ├── kernel.go
│   │   ├── ports.go
│   │   └── process.go
│   ├── main.go
│   ├── Makefile
│   └── utils
│       └── utils.go
├── collect                         # 向客户端收集信息
│   └── web.go
├── config.go                       # 配置文件
├── connect.go                      # 暂时无用
├── depot                           # 仓库，包含漏洞库、poc等
│   ├── banner
│   └── password
│       ├── password.txt
│       └── StrongPassword.txt
├── evaluate.go                     # 后续给出具体评分
├── exploit                         # 比对漏洞库，取得poc，验证漏洞
│   └── password.go
├── go.mod
├── go.sum
├── main.go
├── Makefile
├── temp                            # 原程序代码，等待合并
├── target                          # 靶机管理
│   ├── comm.go                     # 与客户端通信
│   ├── ssh.go                      # 通过ssh连接的靶机
│   └── target.go
└── utils                           # 常用函数
    └── utils.go
```
