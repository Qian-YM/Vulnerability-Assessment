package main

func userCheck() {
    printMsg("## 用户信息检查")

    printMsg("### 可登陆用户")
    printCode(getCommandOutput("bash", "-c", "cat /etc/passwd | egrep -v 'nologin$|false$'"))

    printMsg("### Root权限（非root）账号")
    printCode(getCommandOutput("bash", "-c", "cat /etc/passwd | awk -F ':' '$3==0' | egrep -v root:"))

    printMsg("### /etc/passwd文件修改日期: ")
    printCode(getCommandOutput("bash", "-c", "stat /etc/passwd | grep -P -o '(?<=Modify: ).*'"))

    printMsg("### sudoers(请注意NOPASSWD)")
    printCode(getCommandOutput("bash", "-c", "cat /etc/sudoers | egrep -v '#' | sed -e '/^$/d' | grep -P ALL"))

    printMsg("### 登录信息 w")
    printCode(getCommandOutput("w"))

    printMsg("### 登录信息 last")
    printCode(getCommandOutput("last"))

    printMsg("### 登录信息 lastlog")
    printCode(getCommandOutput("lastlog"))

    printMsg("### 登陆ip")
    printCode(getCommandOutput("bash", "-c", "grep -i -a Accepted /var/log/secure /var/log/auth.* 2>/dev/null | grep -Po '\\d+\\.\\d+\\.\\d+\\.\\d+' | sort | uniq"))
}
