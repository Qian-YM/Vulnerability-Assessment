package main

func crontabCheck() {
	printMsg("## 任务计划检查")

	// Crontab 文件
	printMsg("### Crontab 文件")
	printMsg("crontab -l")
	printCode(getCommandOutput("bash", "-c", "crontab -u root -l | egrep -v '#'"))
	printMsg("ls -alht /etc/cron.*/*")
	printCode(getCommandOutput("bash", "-c","ls -alht /etc/cron.*/*"))

	// Crontab 文件内容
	printMsg("### Crontab 文件内容")
	printCode(getCommandOutput("bash", "-c", "find /var/spool/cron/ -type f -print0 | xargs -0 sudo cat | egrep -v '#'"))
    
	// Crontab 可疑命令
	printMsg("### Crontab Backdoor")
	reverseShellCheck("/etc/cron*")
	reverseShellCheck("/var/spool/cron/*")
}






