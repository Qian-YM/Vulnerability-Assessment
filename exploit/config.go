package exploit

import (
	"os"
)

//var (
//	//targets = []target.SSHTarget{
//	//	target.SSHTarget{
//	//		Addr:           net.ParseIP("125.220.147.45"),
//	//		ProxyAddr:      net.ParseIP("127.0.0.1"),
//	//		SSHPort:        22,
//	//		WebPort:        12345,
//	//		ProxyHttpPort:  8888,
//	//		ProxySocksPort: 1080,
//	//		SSHConfig: &ssh.ClientConfig{
//	//			User:            "debian",
//	//			Auth:            []ssh.AuthMethod{ssh.Password("debian@0721")},
//	//			HostKeyCallback: ssh.InsecureIgnoreHostKey(),
//	//			Timeout:         10 * time.Second,
//	//		},
//	//		Arch: "amd64",
//	//	},
//	//}
//	targets = []target.SSHTarget{
//		target.SSHTarget{
//			ClientTarget: target.ClientTarget{
//				Addr:    net.ParseIP("172.18.0.3"),
//				WebPort: 12345,
//			},
//			//ProxyAddr:      net.ParseIP("127.0.0.1"),
//			SSHPort: 2201,
//			//ProxyHttpPort:  8888,
//			//ProxySocksPort: 1080,
//			SSHConfig: &ssh.ClientConfig{
//				User:            "root",
//				Auth:            []ssh.AuthMethod{ssh.Password("root")},
//				HostKeyCallback: ssh.InsecureIgnoreHostKey(),
//				Timeout:         10 * time.Second,
//			},
//			Arch: "amd64",
//		},
//	}
//)

var (
	UnameDic = map[string][]string{
		"6.1.0-22": {},
	}
	WebDic = map[string][]string{
		"Apache2.4.49": {
			"xray/pocs/apache-httpd-cve-2021-41773-path-traversal.yml",
			"xray/pocs/apache-httpd-cve-2021-41773-rce.yml",
		},
		"phpmyadmin4.8.1": {
			"xray/pocs/phpmyadmin-cve-2018-12613-file-inclusion.yml",
		},
		"unKnown": {},
	}
)

func WebDicInit() {
	dirPath := "./depot/web/xray/pocs"
	dir, _ := os.ReadDir(dirPath)
	for _, file := range dir {
		WebDic["unKnown"] = append(WebDic["unKnown"], "xray/pocs/"+file.Name())
	}
}
